<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Shadow Popup Demo</title>
  <link rel="stylesheet" href="css/style.css">
  <script src="js/mobile-detect.min.js"></script>
  <script src="js/tabs.js"></script>
  <script src="js/popup.js"></script>
</head>
<body>
  <main>

    <!--Only Android-->
    <section class="only-android">
      <div class="phone">
        <div id="only-android" class="example"></div>
      </div>
      <article>
        <p>Visible only in android <a id="show-only-android" href="#">show</a></p>
        <div class="tab-set">
          <ul>
            <li><a href="tpl/oa-main.js.tpl" rel="oa-main">main.js</a></li>
            <li><a href="tpl/oa-options.js.tpl" rel="oa-opts">only-android.js</a></li>
          </ul>
          <div class="tabs">
            <div id="oa-main" class="tab-content"></div>
            <div id="oa-opts" class="tab-content"></div>
          </div>
        </div>
      </article>
    </section>

    <!--Generic-->
    <section>
      <div class="display">
        <div id="generic" class="example"></div>
      </div>
      <article>
        <p>Generic example</p>
        <div class="tab-set">
          <ul>
            <li><a href="tpl/ge-main.js.tpl" rel="ge-main">main.js</a></li>
          </ul>
          <div class="tabs">
            <div id="ge-main" class="tab-content"></div>
          </div>
        </div>
      </article>
    </section>

    <!--Template-->
    <section>
      <div class="display">
        <div id="template" class="example"></div>
      </div>
      <article>
        <p>Custom template</p>
        <div class="tab-set">
          <ul>
            <li><a href="tpl/tp-main.js.tpl" rel="tp-main">main.js</a></li>
            <li><a href="tpl/tp-template.tpl" rel="tp-tpl">template.tpl</a></li>
          </ul>
          <div class="tabs">
            <div id="tp-main" class="tab-content"></div>
            <div id="tp-tpl" class="tab-content"></div>
          </div>
        </div>
      </article>
    </section>

    <!--Change values-->
    <section>
      <div class="display">
        <div id="change" class="example"></div>
      </div>
      <article>
        <p>Real-time change values</p>
        <div class="tab-set">
          <ul>
            <li><a href="tpl/ch-main.js.tpl" rel="tp-main">main.js</a></li>
          </ul>
          <div class="tabs">
            <div id="ch-main" class="tab-content"></div>
          </div>
        </div>
      </article>
    </section>

  </main>

  <script type="text/javascript">
    android = new ShadowPopup({ url: './js/only-android.js' });

    generic = new ShadowPopup({
      shadowParent: document.querySelector('#generic'),
      stylesheets: [
        './css/popup.css',
        '.popup { position: fixed; right: 0; bottom: 0; left: 0; z-index: 1001; }'
      ],
      title: '<h1>Google is a search</h1>',
      buttons: {
        disagree: {
          text: 'Not now',
          attributes: {
            class: 'btn-secondary'
          },
          actions: {
            click: ({ button, event, instance }) => {
              instance.hide();
            }
          }
        },
        agree: {
          text: 'Do something',
          attributes: {
            class: 'btn-primary'
          },
          actions: {
            click: ({ button, event, instance }) => {
              alert('Something!');
            }
          }
        }
      },
      appear: () => true
    });

    template = new ShadowPopup({
      shadowParent: document.querySelector('#template'),
      stylesheets: [
        './css/popup.css',
        '.popup { position: fixed; right: 0; bottom: 0; left: 0; z-index: 1001; }'
      ],
      template: { url: './tpl/custom-popup.tpl' },
      title: '<h1>Popup with custom template</h1>',
      content: '<p>You can customize it all</p>',
      buttons: {
        disagree: {
          text: 'Not now',
          attributes: {
            class: 'btn-secondary'
          },
          actions: {
            click: ({ button, event, instance }) => {
              instance.hide();
            }
          }
        },
        agree: {
          text: 'Do something',
          attributes: {
            class: 'btn-primary'
          },
          actions: {
            click: ({ button, event, instance }) => {
              alert('I do!');
            }
          }
        }
      },
      appear: () => true
    });

    change = new ShadowPopup({
      shadowParent: document.querySelector('#change'),
      stylesheets: [
        './css/popup.css',
        '.popup { position: fixed; right: 0; bottom: 0; left: 0; z-index: 1001; }'
      ],
      title: '<h1 id="title">This title will be changed</h1>',
      content: '<p id="content">This descriptions will be changed</p>',
      buttons: {
        disagree: {
          text: 'It will be changed too',
          attributes: {
            class: 'btn-secondary'
          },
          actions: {
            click: ({ button, event, instance }) => {
              instance.hide();
            }
          }
        },
        agree: {
          text: 'Change it!',
          attributes: {
            class: 'btn-primary'
          },
          actions: {
            click: ({ button, event, instance }) => {
              instance.options.changeIt(instance);
            }
          }
        }
      },
      changeIt: (instance) => {
        /*Generate random text*/
        const generateRandomString = function (length, randomString = '') {
                randomString += Math.random().toString(20).substr(2, length);
                if (randomString.length > length) return randomString.slice(0, length);
                return generateRandomString(length, randomString);
              },
              strings = {
                title: generateRandomString(24),
                content: generateRandomString(36),
                disagree: generateRandomString(12)
              }

        instance.popup.querySelectorAll('*[id]').forEach(el => {
          el.textContent = strings[el.id] || el.textContent;
        });
      },
      appear: (instance) => {
        return true;
      }
    });
  </script>
</body>
</html>